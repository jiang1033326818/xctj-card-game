<!DOCTYPE html>
<html>
<head>
  <title>最小化API测试</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    button { margin: 5px; padding: 5px 10px; }
    pre { background: #f0f0f0; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>最小化API测试</h1>
  
  <button onclick="testPing()">测试Ping</button>
  <button onclick="testLogin()">测试登录</button>
  <button onclick="testHeaders()">测试请求头</button>
  
  <h2>结果:</h2>
  <pre id="result">点击按钮开始测试...</pre>
  
  <script>
    // 最简单的测试函数，使用最少的请求头
    function testPing() {
      document.getElementById('result').textContent = '正在测试Ping...';
      
      var xhr = new XMLHttpRequest();
      xhr.open('GET', '/api/minimal', true);
      
      xhr.onload = function() {
        document.getElementById('result').textContent = 
          'Status: ' + xhr.status + '\n' +
          'Response: ' + xhr.responseText;
      };
      
      xhr.onerror = function() {
        document.getElementById('result').textContent = '请求失败';
      };
      
      xhr.send();
    }
    
    // 最简单的登录测试
    function testLogin() {
      document.getElementById('result').textContent = '正在测试登录...';
      
      var xhr = new XMLHttpRequest();
      xhr.open('POST', '/api/minimal-login-raw', true);
      xhr.setRequestHeader('Content-Type', 'application/json');
      
      xhr.onload = function() {
        document.getElementById('result').textContent = 
          'Status: ' + xhr.status + '\n' +
          'Response: ' + xhr.responseText;
      };
      
      xhr.onerror = function() {
        document.getElementById('result').textContent = '请求失败';
      };
      
      xhr.send(JSON.stringify({
        username: 'admin',
        password: '068162'
      }));
    }
    
    // 测试请求头
    function testHeaders() {
      document.getElementById('result').textContent = '正在测试请求头...';
      
      var xhr = new XMLHttpRequest();
      xhr.open('GET', '/api/headers', true);
      
      xhr.onload = function() {
        document.getElementById('result').textContent = 
          'Status: ' + xhr.status + '\n' +
          'Response: ' + xhr.responseText;
      };
      
      xhr.onerror = function() {
        document.getElementById('result').textContent = '请求失败';
      };
      
      xhr.send();
    }
  </script>
</body>
</html>